tolerations: []
podSecurityContext: {}
securityContext: {}

common-image-stuff: &common-image-stuff
  tag: '1.0-RC30'

service: &common-service-definition
  type: ClusterIP
  servicePort: 8080
  ports:
    - name: http
      port: 8080
      protocol: TCP
      targetPort: http

volumes: &common-volumes
  vol-etc-gscloud:
    configMap:
      name: cm-etc-gscloud


volumeMounts: &common-volume-mounts
  /etc/gscloud:
    name: vol-etc-gscloud


ports: &common-ports
  http:
    containerPort: 8080
    hostIP: 127.0.0.1
  health:
    containerPort: 8081
    hostIP: 127.0.0.1

resources: &common-resources
  requests:
    memory: 512Mi
    cpu: 0.1
  limits:
    memory: 4Gi
    cpu: 4.0

env: &common-env
  GEOSERVER_BASE_PATH:
    # NB: do not put a trailing '/' character
    value: "/geoserver-cloud"
  SPRING_PROFILES_ACTIVE:
    # this must be explicitly overridden with either
    # "standalone,jdbcconfig" or "standalone,datadir"
    value: not-set
  GWC_ENABLED:
    value: "true"
  JAVA_OPTS:
    value: '-DALLOW_ENV_PARAMETRIZATION=true'
  GEOTOOLS_HTTPCLIENT_PROXY_ENABLED:
    value: "false"
  # RABBITMQ_PASSWORD:
  #   type: secret
  #   name: rabbitmq-secret
  #   key: RABBITMQ_PASSWORD
  # GEOSERVER_ADMIN_USERNAME:
  #   type: secret
  #   name: secret-name
  #   key: my-key
  # GEOSERVER_ADMIN_PASSWORD:
  #   type: secret
  #   name: secret-name
  #   key: my-key


common-spring-container-stuff: &common-spring-container-stuff
  resources:
    <<: *common-resources
  ports:
    <<: *common-ports
  volumeMounts:
    <<: *common-volume-mounts
  env:
    <<: *common-env

common-generic-stuff: &common-generic-stuff
  replicaCount: 1
  initContainers: {}
  nodeSelector: {}
  affinity: {}

geoserver:
  ingress:
    enabled: false
    # For example #
    # hostGroups:
    #   host1:
    #     tls:
    #       enabled: false
    #       secretName: 'my-tls-secret'
    #     hosts:
    #       - one.example.com
    #       - two.example.com
    #   host2:
    #     tls:
    #       enabled: true
    #       secretName: 'my-wildcard-tls-secret'
    #     hosts:
    #       - '*.example.com'

  serviceAccount:
    # Specifies whether a service account should be created
    create: false
    # The name of the service account to use.
    # If not set and create is true, a name is generated using the fullname template
    name: default
  services:
    gateway:
      enabled: true
      ingress:
        # NB: if .Values.gscloud.ingress.enabled=true put true here as well
        enabled: false
        path: /geoserver-cloud/
      <<: *common-generic-stuff
      service:
        <<: *common-service-definition
      volumes:
        <<: *common-volumes
      containers:
        spring:
          <<: *common-spring-container-stuff
          image:
            <<: *common-image-stuff
            repository: geoservercloud/geoserver-cloud-gateway
            sha: ''
    webui:
      enabled: true
      ingress:
        enabled: false
      <<: *common-generic-stuff
      service:
        name: webui
        <<: *common-service-definition
      volumes:
        <<: *common-volumes
      containers:
        spring:
          <<: *common-spring-container-stuff
          image:
            <<: *common-image-stuff
            repository: geoservercloud/geoserver-cloud-webui
            sha: ''
    rest:
      enabled: true
      ingress:
        enabled: false
      <<: *common-generic-stuff
      service:
        name: rest
        <<: *common-service-definition
      volumes:
        <<: *common-volumes
      containers:
        spring:
          <<: *common-spring-container-stuff
          image:
            <<: *common-image-stuff
            repository: geoservercloud/geoserver-cloud-rest
            sha: ''
    wfs:
      enabled: true
      ingress:
        enabled: false
      <<: *common-generic-stuff
      service:
        name: wfs
        <<: *common-service-definition
      volumes:
        <<: *common-volumes
      containers:
        spring:
          <<: *common-spring-container-stuff
          image:
            <<: *common-image-stuff
            repository: geoservercloud/geoserver-cloud-wfs
            sha: ''
    wms:
      enabled: true
      ingress:
        enabled: false
      <<: *common-generic-stuff
      service:
        name: wms
        <<: *common-service-definition
      volumes:
        <<: *common-volumes
      containers:
        spring:
          <<: *common-spring-container-stuff
          image:
            <<: *common-image-stuff
            repository: geoservercloud/geoserver-cloud-wms
            sha: ''
    wcs:
      enabled: true
      ingress:
        enabled: false
      <<: *common-generic-stuff
      service:
        name: wcs
        <<: *common-service-definition
      volumes:
        <<: *common-volumes
      containers:
        spring:
          <<: *common-spring-container-stuff
          image:
            <<: *common-image-stuff
            repository: geoservercloud/geoserver-cloud-wcs
            sha: ''
    gwc:
      enabled: true
      ingress:
        enabled: false
      <<: *common-generic-stuff
      service:
        name: gwc
        <<: *common-service-definition
      volumes:
        <<: *common-volumes
      containers:
        spring:
          <<: *common-spring-container-stuff
          image:
            <<: *common-image-stuff
            repository: geoservercloud/geoserver-cloud-gwc
            sha: ''
